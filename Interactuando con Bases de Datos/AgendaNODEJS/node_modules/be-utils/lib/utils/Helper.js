/**
 *  Creator: Christian Hotz
 *  Company: hydra newmedia GmbH
 *  Date: 06.06.16
 *
 *  Copyright hydra newmedia GmbH
 */
"use strict";
/**
 *  Imports
 */
var fs = require('fs');
var _ = require('lodash');
var Helper;
(function (Helper) {
    Helper.fileExists = function (path) {
        if (fs.existsSync) {
            return fs.existsSync(path);
        }
        else {
            try {
                fs.statSync(path);
            }
            catch (err) {
                return !(err.code === 'ENOENT');
            }
            return true;
        }
    };
    Helper.regexReplaceInFile = function (filePath, pattern, replacement, done) {
        if (Helper.fileExists(filePath)) {
            fs.readFile(filePath, 'utf8', function (err, data) {
                if (err) {
                    return console.log(err);
                }
                fs.writeFileSync(filePath + '.bak', data, 'utf8');
                var result = data.replace(pattern, replacement);
                fs.writeFileSync(filePath, result, 'utf8');
                done(true);
            });
        }
        else {
            done(false);
        }
    };
    Helper.unsetEmptySubObjects = function (obj) {
        var prune = function (current) {
            _.forOwn(current, function (value, key) {
                if (_.isUndefined(value) || _.isNull(value) || _.isNaN(value) ||
                    (_.isString(value) && _.isEmpty(value)) ||
                    (_.isObject(value) && _.isEmpty(prune(value)))) {
                    delete current[key];
                }
            });
            if (_.isArray(current)) {
                _.pull(current, undefined);
            }
            return current;
        };
        return prune(obj);
    };
})(Helper = exports.Helper || (exports.Helper = {}));
